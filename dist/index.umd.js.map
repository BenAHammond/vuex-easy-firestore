{"version":3,"file":"index.umd.js","sources":["../src/utils/nanomerge.js","../src/utils/deepmerge.js","../src/module/defaultConfig.js","../src/module/state.js","../src/module/mutations.js","../src/utils/copyObj.js","../src/utils/setDefaultValues.js","../src/utils/debounceHelper.js","../src/utils/objectFlattenToPaths.js","../src/module/actions.js","../src/utils/checkFillables.js","../src/module/getters.js","../src/module/errorCheck.js","../src/module/index.js","../src/index.js"],"sourcesContent":["var nanoclone = require('nanoclone').default\n\nfunction toArray (object) {\n  var result = []\n\n  for (var i = 0; i < object.length; ++i) {\n    result.push(object[i])\n  }\n\n  return result\n}\n\nvar types = [\n  {\n    name: 'primitive',\n\n    is: function (el) {\n      var type = typeof el\n\n      return (type === 'number' || type === 'string' || type === 'boolean')\n    },\n\n    default: 'default',\n\n    merge: {\n      default: function (merger, a, b) {\n        return b\n      }\n    }\n  },\n\n  {\n    name: 'object',\n\n    is: function (el) {\n      return el !== null && (typeof el === 'object')\n    },\n\n    default: 'deep',\n\n    merge: {\n      deep: function (merger, a, b) {\n        var result = {}\n\n        var keys = {\n          a: Object.keys(a),\n          b: Object.keys(b)\n        }\n\n        keys.a.concat(keys.b).forEach(function (key) {\n          result[key] = merger(a[key], b[key])\n        })\n\n        return result\n      }\n    }\n  },\n\n  {\n    name: 'array',\n\n    is: function (el) {\n      return Array.isArray(el)\n    },\n\n    default: 'replace',\n\n    merge: {\n      merge: function (merger, a, b) {\n        var result = []\n\n        for (var i = 0; i < Math.max(a.length, b.length); ++i) {\n          result.push(merger(a[i], b[i]))\n        }\n\n        return result\n      },\n\n      replace: function (merger, a, b) {\n        return nanoclone(b)\n      },\n\n      concat: function (merger, a, b) {\n        return (([]).concat(a)).concat(b)\n      }\n    }\n  }\n]\n\nfunction merge (config) {\n  if (!config) {\n    config = {}\n  }\n\n  config = {\n    strategy: config.strategy || {}\n  }\n\n  function determineType (a, b) {\n    for (var i = types.length - 1; i >= 0; --i) {\n      var type = types[i]\n\n      if (type.is(a) && type.is(b)) {\n        return type\n      } else if (type.is(a) || type.is(b)) {\n        break\n      }\n    }\n\n    return null\n  }\n\n  function merger (a, b) {\n    if (b === void 0) {\n      return nanoclone(a)\n    }\n\n    var type = determineType(a, b)\n\n    if (!type) {\n      return nanoclone(b)\n    }\n\n    var strategy = config.strategy[type.name] || type.default\n\n    return type.merge[strategy](merger, a, b)\n  }\n\n  return function () {\n    var elements = toArray(arguments)\n\n    return elements.reduceRight(function (result, element) {\n      return merger(element, result)\n    })\n  }\n}\n\nfunction wrapper () {\n  var args = toArray(arguments)\n\n  // custom config\n  if (args.length === 1) {\n    return merge(args[0])\n  }\n\n  return merge().apply(null, args)\n}\n\nexport default wrapper\n// module.exports = wrapper\n","import { isObject } from 'is-what'\nimport deepmerge from './nanomerge'\n\nfunction merge (...params) {\n  let l = params.length\n  for (l; l > 0; l--) {\n    const item = params[l - 1]\n    if (!isObject(item)) {\n      console.error('trying to merge a non-object: ', item)\n      return item\n    }\n  }\n  return deepmerge(...params)\n}\n\nexport default merge\n","\nexport default {\n  firestorePath: '',\n    // The path to a collection or doc in firestore. You can use `{userId}` which will be replaced with the user Id.\n  firestoreRefType: '',\n    // `'collection'` or `'doc'`. Depending on your `firestorePath`.\n  moduleName: '',\n    // The module name. Can be nested, eg. `'user/items'`\n  statePropName: '',\n    // The name of the property where the docs or doc will be synced to. If left blank it will be synced on the state of the module. (Please see [Sync directly to module state](#sync-directly-to-module-state) for more info)\n\n  // Related to the 2-way sync:\n  sync: {\n    where: [],\n    orderBy: [],\n    fillables: [],\n    guard: [],\n  },\n\n  // HOOKS:\n  insertHook: function (updateStore, doc, store) { return updateStore(doc) },\n  patchHook: function (updateStore, doc, store) { return updateStore(doc) },\n  deleteHook: function (updateStore, id, store) { return updateStore(id) },\n\n  // When items on the server side are changed:\n  serverChange: {\n    defaultValues: {},\n    // HOOKS for changes on SERVER:\n    addedHook: function (updateStore, doc, id, store, source, change) { return updateStore(doc) },\n    modifiedHook: function (updateStore, doc, id, store, source, change) { return updateStore(doc) },\n    removedHook: function (updateStore, doc, id, store, source, change) { return updateStore(doc) },\n  },\n\n  // When items are fetched through `dispatch('module/fetch', filters)`.\n  fetch: {\n    // The max amount of documents to be fetched. Defaults to 50.\n    docLimit: 50,\n  },\n\n  // You can also add custom state/getters/mutations/actions. These will be added to your module.\n  state: {},\n  getters: {},\n  mutations: {},\n  actions: {},\n}\n","\nexport default {\n  _sync: {\n    signedIn: false,\n    patching: false,\n    syncStack: {\n      updates: {},\n      deletions: [],\n      inserts: [],\n      debounceTimer: null\n    },\n    fetched: [],\n    stopPatchingTimeout: null\n  }\n}\n","import { defaultMutations } from 'vuex-easy-access'\nimport { isObject } from 'is-what'\nimport merge from '../utils/deepmerge'\n\nconst mutations = {\n  resetSyncStack (state) {\n    state._sync.syncStack = {\n      updates: {},\n      deletions: [],\n      inserts: [],\n      debounceTimer: null\n    }\n  },\n  INSERT_DOC (state, doc) {\n    if (state._conf.firestoreRefType.toLowerCase() === 'doc') return\n    this._vm.$set(state[state._conf.statePropName], doc.id, doc)\n  },\n  PATCH_DOC (state, doc) {\n    if (state._conf.firestoreRefType.toLowerCase() === 'doc') {\n      if (!state._conf.statePropName) {\n        return Object.keys(doc).forEach(key => {\n          // Merge if exists\n          const newVal = (state[key] === undefined)\n            ? doc[key]\n            : (!isObject(state[key]) || !isObject(doc[key]))\n              ? doc[key]\n              : merge(state[key], doc[key])\n          this._vm.$set(state, key, newVal)\n        })\n      }\n      // state[state._conf.statePropName] will always be an empty object by default\n      state[state._conf.statePropName] = merge(state[state._conf.statePropName], doc)\n      return\n    }\n    // Merge if exists\n    const newVal = (state[state._conf.statePropName][doc.id] === undefined)\n      ? doc\n      : (!isObject(state[state._conf.statePropName][doc.id]) || !isObject(doc))\n        ? doc\n        : merge(state[state._conf.statePropName][doc.id], doc)\n    this._vm.$set(state[state._conf.statePropName], doc.id, newVal)\n  },\n  DELETE_DOC (state, id) {\n    if (state._conf.firestoreRefType.toLowerCase() === 'doc') return\n    this._vm.$delete(state[state._conf.statePropName], id)\n  }\n}\n\nexport default function (userMutations = {}, state) {\n  const vuexEasyMutations = defaultMutations(state)\n  return Object.assign({}, vuexEasyMutations, mutations, userMutations)\n}\n","/**\n * copyObj helper\n *\n * @author     Adam Dorling\n * @contact    https://codepen.io/naito\n */\nexport default function copyObj (obj) {\n  let newObj\n  if (typeof obj != 'object') {\n    return obj\n  }\n  if (!obj) {\n    return obj\n  }\n  if ('[object Object]' !== Object.prototype.toString.call(obj) ||\n    '[object Array]' !== Object.prototype.toString.call(obj)\n  ) {\n    return JSON.parse(JSON.stringify(obj))\n  }\n  // Object is an Array\n  if ('[object Array]' === Object.prototype.toString.call(obj)) {\n    newObj = []\n    for (let i = 0, len = obj.length; i < len; i++) {\n      newObj[i] = copyObj(obj[i])\n    }\n    return newObj\n  }\n  // Object is an Object\n  newObj = {}\n  for (let i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      newObj[i] = copyObj(obj[i])\n    }\n  }\n  return newObj\n}\n","import merge from './deepmerge'\n\n/**\n * Sets default values on an object\n *\n * @param {object} obj on which to set the default values\n * @param {object} defaultValues the default values\n */\nexport default function (obj, defaultValues) {\n  return merge(defaultValues, obj)\n}\n","/**\n * debounce helper\n *\n * @author     Adam Dorling\n * @contact    https://codepen.io/naito\n */\n\n// USAGE:\n// let d = startDebounce(1000)\n// d.done.then(_ => handle())\n// d.refresh() // to refresh\n\nexport default function (ms) {\n  let startTime = Date.now()\n  const done = new Promise((resolve, reject) => {\n    const interval = setInterval(_ => {\n      const now = Date.now()\n      const deltaT = now - startTime\n      if (deltaT >= ms) {\n        clearInterval(interval)\n        resolve(true)\n      }\n    }, 10)\n  })\n  const refresh = () => (startTime = Date.now())\n  return { done, refresh }\n}\n","import { isObject } from 'is-what'\n\nfunction retrievePaths (object, path, result) {\n  if (!isObject(object) || !Object.keys(object).length) {\n    if (!path) return object\n    result[path] = object\n    return result\n  }\n  return Object.keys(object).reduce((carry, key) => {\n    const pathUntilNow = (path)\n      ? path + '.'\n      : ''\n    const newPath = pathUntilNow + key\n    const extra = retrievePaths(object[key], newPath, result)\n    return Object.assign(carry, extra)\n  }, {})\n}\n\nexport default function (object) {\n  const result = {}\n  return retrievePaths(object, null, result)\n}\n","import Firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport 'firebase/auth'\nimport { isArray, isString } from 'is-what'\nimport merge from '../utils/deepmerge'\nimport copyObj from '../utils/copyObj'\nimport setDefaultValues from '../utils/setDefaultValues'\nimport startDebounce from '../utils/debounceHelper'\nimport flattenToPaths from '../utils/objectFlattenToPaths'\n\nconst actions = {\n  patchDoc (\n    {state, getters, commit, dispatch},\n    {id = '', ids = [], doc} = {ids: [], doc: {}}\n  ) {\n    // 0. payload correction (only arrays)\n    if (!isArray(ids)) return console.log('ids needs to be an array')\n    if (id) ids.push(id)\n    if (doc.id) delete doc.id\n\n    // 1. Prepare for patching\n    let syncStackItems = getters.prepareForPatch(ids, doc)\n\n    // 2. Push to syncStack\n    Object.keys(syncStackItems).forEach(id => {\n      const newVal = (!state._sync.syncStack.updates[id])\n        ? syncStackItems[id]\n        : merge(state._sync.syncStack.updates[id],\n                syncStackItems[id])\n      state._sync.syncStack.updates[id] = newVal\n    })\n\n    // 3. Create or refresh debounce\n    return dispatch('handleSyncStackDebounce')\n  },\n  deleteDoc ({state, getters, commit, dispatch},\n  ids = []) {\n    // 0. payload correction (only arrays)\n    if (!isArray(ids)) ids = [ids]\n\n    // 1. Prepare for patching\n    const syncStackIds = getters.prepareForDeletion(ids)\n\n    // 2. Push to syncStack\n    const deletions = state._sync.syncStack.deletions.concat(syncStackIds)\n    state._sync.syncStack.deletions = deletions\n\n    if (!state._sync.syncStack.deletions.length) return\n    // 3. Create or refresh debounce\n    return dispatch('handleSyncStackDebounce')\n  },\n  insertDoc ({state, getters, commit, dispatch},\n  docs = []) {\n    // 0. payload correction (only arrays)\n    if (!isArray(docs)) docs = [docs]\n\n    // 1. Prepare for patching\n    const syncStack = getters.prepareForInsert(docs)\n\n    // 2. Push to syncStack\n    const inserts = state._sync.syncStack.inserts.concat(syncStack)\n    state._sync.syncStack.inserts = inserts\n\n    // 3. Create or refresh debounce\n    return dispatch('handleSyncStackDebounce')\n  },\n  handleSyncStackDebounce ({state, commit, dispatch, getters}) {\n    if (!getters.signedIn) return false\n    if (!state._sync.syncStack.debounceTimer) {\n      const debounceTimer = startDebounce(1000)\n      debounceTimer.done.then(_ => dispatch('batchSync'))\n      state._sync.syncStack.debounceTimer = debounceTimer\n    }\n    state._sync.syncStack.debounceTimer.refresh()\n  },\n  batchSync ({getters, commit, dispatch, state}) {\n    const collectionMode = getters.collectionMode\n    const dbRef = getters.dbRef\n    let batch = Firebase.firestore().batch()\n    let count = 0\n    // Add 'updateds' to batch\n    let updatesOriginal = copyObj(state._sync.syncStack.updates)\n    let updates = Object.keys(updatesOriginal).map(k => {\n      let fields = updatesOriginal[k]\n      return {id: k, fields}\n    })\n    // Check if there are more than 500 batch items already\n    if (updates.length >= 500) {\n      // Batch supports only until 500 items\n      count = 500\n      let updatesOK = updates.slice(0, 500)\n      let updatesLeft = updates.slice(500, -1)\n      // Put back the remaining items over 500\n      state._sync.syncStack.updates = updatesLeft.reduce((carry, item) => {\n        carry[item.id] = item\n        delete item.id\n        return carry\n      }, {})\n      updates = updatesOK\n    } else {\n      state._sync.syncStack.updates = {}\n      count = updates.length\n    }\n    // Add to batch\n    updates.forEach(item => {\n      let id = item.id\n      let docRef = (collectionMode) ? dbRef.doc(id) : dbRef\n      let fields = flattenToPaths(item.fields)\n      console.log('fields → ', fields)\n      batch.update(docRef, fields)\n    })\n    // Add 'deletions' to batch\n    let deletions = copyObj(state._sync.syncStack.deletions)\n    // Check if there are more than 500 batch items already\n    if (count >= 500) {\n      // already at 500 or more, leave items in syncstack, and don't add anything to batch\n      deletions = []\n    } else {\n      // Batch supports only until 500 items\n      let deletionsAmount = 500 - count\n      let deletionsOK = deletions.slice(0, deletionsAmount)\n      let deletionsLeft = deletions.slice(deletionsAmount, -1)\n      // Put back the remaining items over 500\n      state._sync.syncStack.deletions = deletionsLeft\n      count = count + deletionsOK.length\n      // Define the items we'll add below\n      deletions = deletionsOK\n    }\n    // Add to batch\n    deletions.forEach(id => {\n      let docRef = dbRef.doc(id)\n      batch.delete(docRef)\n    })\n    // Add 'inserts' to batch\n    let inserts = copyObj(state._sync.syncStack.inserts)\n    // Check if there are more than 500 batch items already\n    if (count >= 500) {\n      // already at 500 or more, leave items in syncstack, and don't add anything to batch\n      inserts = []\n    } else {\n      // Batch supports only until 500 items\n      let insertsAmount = 500 - count\n      let insertsOK = inserts.slice(0, insertsAmount)\n      let insertsLeft = inserts.slice(insertsAmount, -1)\n      // Put back the remaining items over 500\n      state._sync.syncStack.inserts = insertsLeft\n      count = count + insertsOK.length\n      // Define the items we'll add below\n      inserts = insertsOK\n    }\n    // Add to batch\n    inserts.forEach(item => {\n      let newRef = getters.dbRef.doc(item.id)\n      batch.set(newRef, item)\n    })\n    // Commit the batch:\n    // console.log(`[batchSync] START:\n    //   ${Object.keys(updates).length} updates,\n    //   ${deletions.length} deletions,\n    //   ${inserts.length} inserts`\n    // )\n    dispatch('_startPatching')\n    state._sync.syncStack.debounceTimer = null\n    return new Promise((resolve, reject) => {\n      batch.commit()\n      .then(res => {\n        console.log(`[batchSync] RESOLVED:`, res, `\n          updates: `, Object.keys(updates).length ? updates : {}, `\n          deletions: `, deletions.length ? deletions : [], `\n          inserts: `, inserts.length ? inserts : []\n        )\n        let remainingSyncStack = Object.keys(state._sync.syncStack.updates).length\n          + state._sync.syncStack.deletions.length\n          + state._sync.syncStack.inserts.length\n        if (remainingSyncStack) { dispatch('batchSync') }\n        dispatch('_stopPatching')\n        return resolve()\n        // // Fetch the item if it was added as an Archived item:\n        // if (item.archived) {\n          //   get_ters.dbRef.doc(res.id).get()\n          //   .then(doc => {\n            //     let tempId = doc.data().id\n            //     let id = doc.id\n            //     let item = doc.data()\n            //     item.id = id\n            //     console.log('retrieved Archived new item: ', id, item)\n            //     dispatch('newItemFromServer', {item, tempId})\n            //   })\n            // }\n      }).catch(error => {\n        state._sync.patching = 'error'\n        state._sync.syncStack.debounceTimer = null\n        return reject()\n      })\n    })\n  },\n  fetch (\n    {state, getters, commit, dispatch},\n    {whereFilters = [], orderBy = []} = {whereFilters: [], orderBy: []}\n    // whereFilters: [['archived', '==', true]]\n    // orderBy: ['done_date', 'desc']\n  ) {\n    return new Promise((resolve, reject) => {\n      console.log('[fetch] starting')\n      if (!getters.signedIn) return resolve()\n      const identifier = JSON.stringify({whereFilters, orderBy})\n      const fetched = state._sync.fetched[identifier]\n      // We've never fetched this before:\n      if (!fetched) {\n        let ref = getters.dbRef\n        // apply where filters and orderBy\n        whereFilters.forEach(paramsArr => {\n          ref = ref.where(...paramsArr)\n        })\n        if (orderBy.length) {\n          ref = ref.orderBy(...orderBy)\n        }\n        state._sync.fetched[identifier] = {\n          ref,\n          done: false,\n          retrievedFetchRefs: [],\n          nextFetchRef: null\n        }\n      }\n      const fRequest = state._sync.fetched[identifier]\n      // We're already done fetching everything:\n      if (fRequest.done) {\n        console.log('done fetching')\n        return resolve('fetchedAll')\n      }\n      // attach fetch filters\n      let fRef = state._sync.fetched[identifier].ref\n      if (fRequest.nextFetchRef) {\n        // get next ref if saved in state\n        fRef = state._sync.fetched[identifier].nextFetchRef\n      }\n      fRef = fRef.limit(state._conf.fetch.docLimit)\n      // Stop if all records already fetched\n      if (fRequest.retrievedFetchRefs.includes(fRef)) {\n        console.log('Already retrieved this part.')\n        return resolve()\n      }\n      // make fetch request\n      fRef.get()\n      .then(querySnapshot => {\n        const docs = querySnapshot.docs\n        if (docs.length === 0) {\n          state._sync.fetched[identifier].done = true\n          resolve('fetchedAll')\n\n          return\n        }\n        if (docs.length < state._conf.fetch.docLimit) {\n          state._sync.fetched[identifier].done = true\n        }\n        state._sync.fetched[identifier].retrievedFetchRefs.push(fetchRef)\n        // Get the last visible document\n        resolve(querySnapshot)\n        const lastVisible = docs[docs.length - 1]\n        // get the next records.\n        const next = fRef.startAfter(lastVisible)\n        state._sync.fetched[identifier].nextFetchRef = next\n      }).catch(error => {\n        console.log(error)\n        return reject(error)\n      })\n    })\n  },\n  serverUpdate ({commit}, {change, id, doc = {}}) {\n    doc.id = id\n    switch (change) {\n      case 'added':\n        commit('INSERT_DOC', doc)\n        break\n      case 'removed':\n        commit('DELETE_DOC', id)\n        break\n      default:\n        commit('PATCH_DOC', doc)\n        break\n    }\n  },\n  openDBChannel ({getters, state, commit, dispatch}) {\n    if (Firebase.auth().currentUser) state._sync.signedIn = true\n    const collectionMode = getters.collectionMode\n    let dbRef = getters.dbRef\n    // apply where filters and orderBy\n    if (state._conf.firestoreRefType.toLowerCase() !== 'doc') {\n      state._conf.sync.where.forEach(paramsArr => {\n        dbRef = dbRef.where(...paramsArr)\n      })\n      if (state._conf.sync.orderBy.length) {\n        dbRef = dbRef.orderBy(...state._conf.sync.orderBy)\n      }\n    }\n    // define handleDoc()\n    function handleDoc (change, id, doc, source) {\n      change = (!change) ? 'modified' : change.type\n      // define storeUpdateFn()\n      function storeUpdateFn (_doc) {\n        return dispatch('serverUpdate', {change, id, doc: _doc})\n      }\n      // get user set sync hook function\n      const syncHookFn = state._conf.sync[change + 'Hook']\n      if (syncHookFn) {\n        syncHookFn(storeUpdateFn, doc, id, this, source, change)\n      } else {\n        storeUpdateFn(doc)\n      }\n    }\n    // make a promise\n    return new Promise ((resolve, reject) => {\n      dbRef\n      .onSnapshot(querySnapshot => {\n        let source = querySnapshot.metadata.hasPendingWrites ? 'local' : 'server'\n        if (!collectionMode) {\n          const doc = setDefaultValues(querySnapshot.data(), state._conf.serverChange.defaultValues)\n          if (source === 'local') return resolve()\n          handleDoc(null, null, doc, source)\n          return resolve()\n        }\n        querySnapshot.docChanges().forEach(change => {\n          // Don't do anything for local modifications & removals\n          if (source === 'local' &&\n            (change.type === 'modified' || change.type === 'removed')\n          ) {\n            return resolve()\n          }\n          const id = change.doc.id\n          const doc = (change.type === 'added')\n            ? setDefaultValues(change.doc.data(), state._conf.serverChange.defaultValues)\n            : change.doc.data()\n          handleDoc(change, id, doc, source)\n          return resolve()\n        })\n      }, error => {\n        state._sync.patching = 'error'\n        return reject(error)\n      })\n    })\n  },\n  set ({commit, dispatch, getters, state}, doc) {\n    if (!doc) return\n    if (!getters.collectionMode) {\n      return dispatch('patch', doc)\n    }\n    if (!doc.id || !state[state._conf.statePropName][doc.id]) {\n      return dispatch('insert', doc)\n    }\n    return dispatch('patch', doc)\n  },\n  insert ({state, getters, commit, dispatch}, doc) {\n    if (!doc) return\n    if (!doc.id) doc.id = getters.dbRef.doc().id\n    // define the store update\n    function storeUpdateFn (_doc) {\n      commit('INSERT_DOC', _doc)\n      return dispatch('insertDoc', _doc)\n    }\n    // check for hooks\n    if (state._conf.insertHook) {\n      return state._conf.insertHook(storeUpdateFn, doc, this)\n    }\n    return storeUpdateFn(doc)\n  },\n  patch ({state, getters, commit, dispatch}, doc) {\n    if (!doc) return\n    if (!doc.id && getters.collectionMode) return\n    // define the store update\n    function storeUpdateFn (_doc) {\n      commit('PATCH_DOC', _doc)\n      return dispatch('patchDoc', {id: _doc.id, doc: _doc})\n    }\n    // check for hooks\n    if (state._conf.patchHook) {\n      return state._conf.patchHook(storeUpdateFn, doc, this)\n    }\n    return storeUpdateFn(doc)\n  },\n  patchBatch (\n    {state, getters, commit, dispatch},\n    {doc, ids = []}\n  ) {\n    if (!doc) return\n    // define the store update\n    function storeUpdateFn (_doc) {\n      commit('PATCH_DOC', _doc)\n      return dispatch('patchDoc', {ids, doc: _doc})\n    }\n    // check for hooks\n    if (state._conf.patchHook) {\n      return state._conf.patchHook(storeUpdateFn, doc, this)\n    }\n    return storeUpdateFn(doc)\n  },\n  delete ({state, getters, commit, dispatch}, id) {\n    // define the store update\n    function storeUpdateFn (_id) {\n      commit('DELETE_DOC', _id)\n      return dispatch('deleteDoc', _id)\n    }\n    // check for hooks\n    if (state._conf.deleteHook) {\n      return state._conf.deleteHook(storeUpdateFn, id, this)\n    }\n    return storeUpdateFn(id)\n  },\n  _stopPatching ({state, commit}) {\n    if (state._sync.stopPatchingTimeout) { clearTimeout(state._sync.stopPatchingTimeout) }\n    state._sync.stopPatchingTimeout = setTimeout(_ => { state._sync.patching = false }, 300)\n  },\n  _startPatching ({state, commit}) {\n    if (state._sync.stopPatchingTimeout) { clearTimeout(state._sync.stopPatchingTimeout) }\n    state._sync.patching = true\n  }\n}\n\nexport default function (userActions = {}) {\n  return Object.assign({}, actions, userActions)\n}\n","\nimport { isObject } from 'is-what'\n/**\n * Checks all props of an object and deletes guarded and non-fillables.\n *\n * @param {object}  obj       the target object to check\n * @param {array}   fillables an array of strings, with the props which should be allowed on returned object\n * @param {array}   guard     an array of strings, with the props which should NOT be allowed on returned object\n *\n * @returns {object} the cleaned object after deleting guard and non-fillables\n */\nexport default function (obj, fillables = [], guard = []) {\n  if (!isObject(obj)) return obj\n  if (fillables.length) {\n    Object.keys(obj).forEach(key => {\n      if (!fillables.includes(key)) {\n        delete obj[key]\n      }\n    })\n  }\n  guard.forEach(key => {\n    delete obj[key]\n  })\n  return obj\n}\n","import Firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport 'firebase/auth'\nimport copyObj from '../utils/copyObj'\nimport { getDeepRef } from 'vuex-easy-access'\nimport checkFillables from '../utils/checkFillables'\n\nconst getters = {\n  signedIn: (state, getters, rootState, rootGetters) => {\n    return state._sync.signedIn\n  },\n  dbRef: (state, getters, rootState, rootGetters) => {\n    if (!getters.signedIn) return false\n    if (!Firebase.auth().currentUser) return false\n    const userId = Firebase.auth().currentUser.uid\n    const path = state._conf.firestorePath.replace('{userId}', userId)\n    return (state._conf.firestoreRefType.toLowerCase() === 'collection')\n      ? Firebase.firestore().collection(path)\n      : Firebase.firestore().doc(path)\n  },\n  storeRef: (state, getters, rootState) => {\n    const path = (state._conf.statePropName)\n      ? `${state._conf.moduleName}/${state._conf.statePropName}`\n      : state._conf.moduleName\n    return getDeepRef(rootState, path)\n  },\n  collectionMode: (state, getters, rootState) => {\n    return (state._conf.firestoreRefType.toLowerCase() === 'collection')\n  },\n  prepareForPatch: (state, getters, rootState, rootGetters) =>\n  (ids = [], doc = {}) => {\n    // get relevant data from the storeRef\n    const collectionMode = getters.collectionMode\n    if (!collectionMode) ids.push('singleDoc')\n    // returns {object} -> {id: data}\n    return ids.reduce((carry, id) => {\n      let patchData = {}\n      // retrieve full object\n      if (!Object.keys(doc).length) {\n        patchData = (collectionMode)\n          ? getters.storeRef[id]\n          : getters.storeRef\n      } else {\n        patchData = doc\n      }\n      patchData = copyObj(patchData)\n      patchData = checkFillables(patchData, state._conf.sync.fillables, state._conf.sync.guard)\n      patchData.updated_at = Firebase.firestore.FieldValue.serverTimestamp()\n      carry[id] = patchData\n      return carry\n    }, {})\n  },\n  prepareForDeletion: (state, getters, rootState, rootGetters) =>\n  (ids = []) => {\n    return ids.reduce((carry, id) => {\n      carry.push(id)\n      return carry\n    }, [])\n  },\n  prepareForInsert: (state, getters, rootState, rootGetters) =>\n  (items = []) => {\n    items = copyObj(items)\n    return items.reduce((carry, item) => {\n      item = checkFillables(item, state._conf.sync.fillables, state._conf.sync.guard)\n      item.created_at = Firebase.firestore.FieldValue.serverTimestamp()\n      item.created_by = rootGetters['user/id']\n      carry.push(item)\n      return carry\n    }, [])\n  }\n}\n\nexport default function (userGetters = {}) {\n  return Object.assign({}, getters, userGetters)\n}\n","\nexport default function errorCheck (config) {\n  let reqProps = ['firestorePath', 'moduleName']\n  reqProps.forEach(prop => {\n    if (!config[prop]) {\n      console.error(`Missing ${prop} from your config!`)\n      return false\n    }\n  })\n  if (/(\\.|\\/)/.test(config.statePropName)) {\n    console.error(`statePropName must only include letters from [a-z]`)\n    return false\n  }\n  if (/\\./.test(config.moduleName)) {\n    console.error(`moduleName must only include letters from [a-z] and forward slashes '/'`)\n    return false\n  }\n  return true\n}\n","import merge from '../utils/deepmerge'\n// store\nimport defaultConfig from './defaultConfig'\nimport initialState from './state'\nimport iniMutations from './mutations'\nimport iniActions from './actions'\nimport iniGetters from './getters'\nimport errorCheck from './errorCheck'\n\n/**\n * A function that returns a vuex module object with seamless 2-way sync for firestore.\n *\n * @param {object} userConfig Takes a config object as per ...\n * @returns {object} the module ready to be included in your vuex store\n */\nexport default function (userConfig) {\n  const conf = merge(defaultConfig, userConfig)\n  if (!errorCheck(conf)) return\n  const userState = conf.state\n  const userMutations = conf.mutations\n  const userActions = conf.actions\n  const userGetters = conf.getters\n  delete conf.state\n  delete conf.mutations\n  delete conf.actions\n  delete conf.getters\n\n  const docContainer = {}\n  if (conf.statePropName) docContainer[conf.statePropName] = {}\n  const state = merge(initialState, userState, docContainer, {_conf: conf})\n  return {\n    namespaced: true,\n    state,\n    mutations: iniMutations(userMutations, merge(initialState, userState)),\n    actions: iniActions(userActions),\n    getters: iniGetters(userGetters)\n  }\n}\n","import Firebase from 'firebase/app'\nimport 'firebase/auth'\nimport { getKeysFromPath } from 'vuex-easy-access'\nimport { isArray } from 'is-what'\nimport iniModule from './module/index'\n\nexport default function createEasyFirestore (userConfig) {\n  return store => {\n    // Get an array of config files\n    if (!isArray(userConfig)) userConfig = [userConfig]\n    // Create a module for each config file\n    userConfig.forEach(config => {\n      const moduleName = getKeysFromPath(config.moduleName)\n      store.registerModule(moduleName, iniModule(config))\n    })\n    store.setDoc = (path, payload) => {\n      return store.dispatch(path + '/setDoc', payload)\n    }\n    store.insert = (path, payload) => {\n      return store.dispatch(path + '/insert', payload)\n    }\n    store.patch = (path, payload) => {\n      return store.dispatch(path + '/patch', payload)\n    }\n    store.patchBatch = (path, payload) => {\n      return store.dispatch(path + '/patchBatch', payload)\n    }\n    store.delete = (path, payload) => {\n      return store.dispatch(path + '/delete', payload)\n    }\n  }\n}\n"],"names":["nanoclone","require","default","toArray","object","result","i","length","push","types","name","is","el","type","merge","merger","a","b","deep","keys","Object","concat","forEach","key","Array","isArray","Math","max","replace","config","strategy","determineType","elements","arguments","reduceRight","element","wrapper","args","apply","l","item","isObject","console","error","deepmerge","firestorePath","firestoreRefType","moduleName","statePropName","sync","where","orderBy","fillables","guard","insertHook","updateStore","doc","store","patchHook","deleteHook","id","serverChange","defaultValues","addedHook","source","change","modifiedHook","removedHook","fetch","docLimit","state","getters","mutations","actions","_sync","signedIn","patching","syncStack","updates","deletions","inserts","debounceTimer","fetched","stopPatchingTimeout","resetSyncStack","INSERT_DOC","_conf","toLowerCase","_vm","$set","PATCH_DOC","newVal","undefined","DELETE_DOC","$delete","userMutations","vuexEasyMutations","defaultMutations","assign","copyObj","obj","newObj","prototype","toString","call","JSON","parse","stringify","len","hasOwnProperty","ms","startTime","Date","now","done","Promise","resolve","reject","interval","setInterval","deltaT","clearInterval","refresh","retrievePaths","path","reduce","carry","pathUntilNow","newPath","extra","patchDoc","commit","dispatch","ids","log","syncStackItems","prepareForPatch","deleteDoc","syncStackIds","prepareForDeletion","insertDoc","docs","prepareForInsert","handleSyncStackDebounce","startDebounce","then","batchSync","collectionMode","dbRef","batch","Firebase","firestore","count","updatesOriginal","map","fields","k","updatesOK","slice","updatesLeft","docRef","flattenToPaths","update","deletionsAmount","deletionsOK","deletionsLeft","delete","insertsAmount","insertsOK","insertsLeft","newRef","set","res","remainingSyncStack","catch","whereFilters","identifier","ref","paramsArr","retrievedFetchRefs","nextFetchRef","fRequest","fRef","limit","includes","get","querySnapshot","fetchRef","lastVisible","next","startAfter","serverUpdate","openDBChannel","auth","currentUser","handleDoc","storeUpdateFn","_doc","syncHookFn","onSnapshot","metadata","hasPendingWrites","setDefaultValues","data","docChanges","insert","patch","patchBatch","_id","_stopPatching","clearTimeout","setTimeout","_startPatching","userActions","rootState","rootGetters","userId","uid","collection","storeRef","getDeepRef","patchData","checkFillables","updated_at","FieldValue","serverTimestamp","items","created_at","created_by","userGetters","errorCheck","reqProps","prop","test","userConfig","conf","defaultConfig","userState","docContainer","initialState","namespaced","iniMutations","iniActions","iniGetters","createEasyFirestore","getKeysFromPath","registerModule","iniModule","setDoc","payload"],"mappings":"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"}